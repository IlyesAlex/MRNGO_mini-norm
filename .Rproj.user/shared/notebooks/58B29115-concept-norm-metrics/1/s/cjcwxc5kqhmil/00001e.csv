"0",""
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(ggpubr)"
"0",""
"0","# 1) compute avg features-per-concept by ID"
"0","id_avg <- mrngo_data_cleaned %>% "
"0","  distinct(ID, concept, feature) %>%     # one row per ID–concept–feature"
"0","  count(ID, concept, name = ""n_feats"") %>%  # how many features each ID gave for each concept"
"0","  group_by(ID) %>% "
"0","  summarise(avg_feats = mean(n_feats, na.rm = TRUE)) %>% "
"0","  ungroup()"
"0",""
"0","# 2) pull out each ID’s age & sex (assumed unique per ID)"
"0","demog <- mrngo_data_cleaned %>% "
"0","  select(ID, age, sex) %>% "
"0","  distinct(ID, .keep_all = TRUE)"
"0",""
"0","id_demo <- left_join(id_avg, demog, by = ""ID"")"
"0",""
"0","id_demo_clean <- id_demo %>%"
"0","  mutate("
"0","    age_f = factor(age, levels = sort(unique(age)))"
"0","  )"
"0",""
"0","# 3) BAR + error‐bars (mean ± SE)"
"0","p3 <- ggplot(id_demo_clean, aes(x = age_f, y = avg_feats, fill = sex)) +"
"0","  stat_summary("
"0","    fun = mean, geom = ""col"","
"0","    position = position_dodge(width = 0.8),"
"0","    width = 0.6"
"0","  ) +"
"0","  stat_summary("
"0","    fun.data = mean_se, geom = ""errorbar"","
"0","    position = position_dodge(width = 0.8),"
"0","    width = 0.2"
"0","  ) +"
"0","  scale_fill_manual(values = c(female = ""#F17C5D"", male = ""#5DA8D3"")) +"
"0","  labs("
"0","    x    = ""Age"","
"0","    y    = ""Avg. features per concept"","
"0","    fill = ""Sex"","
"0","    title = NULL"
"0","  ) +"
"0","  custom_theme"
"0",""
"0","# draw whichever you like:"
"0","print(p3)"
